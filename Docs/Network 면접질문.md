# Network 면접질문

### Network

- **Network란**
  - 사용자 혹은 데이터가 어떤 곳에서 다른 곳으로 이동할 수 있게 만든 통로이다.

### OSI(Open System Interconnection) 7계층

- **OSI 7계층이란**

  - 두 개체간에 서로 통신할 경우 연결 과정을 7단계로 나누어 놓은 것
  - 네트워크 분야에서 가장 중요하게 다루는 것으로서 세계적으로 사용이 되고 있는 네트워크 표준 모델이다. 이 안에 TCP/IP 및 네트워크 통신에 사용되는 전반적인 **프로토콜**(인터넷을 사용할 때 따라야하는 규칙)이 모두 포함되어 있다. 어떻게 인터넷을 통해서 통신을 하게 되는지 그 과정을 자세히 다룬 모델이다.
  - '네트워크를 구상할 때 이것을 참조해서 만들어라'라고 하는 참조 모델이다.

  ![img](../Pictures/OSI_7-Layer.jpg)

  - 1계층 : 물리층  : 실제로 장치들을 연결하기 위한 물리적인 사항을 정의한다.
  - 2계층 : 데이터 링크층 : 두 지점 간의 신뢰성 있는 전송을 보장한다.
    - 데이터 링크 층에서 각 지점들을 분류하는 방법은 MAC주소이다.
    - MAC주소 : 모든 장치 마다 1개씩 가지고 있는 고유한 물리적 주소이다.(랜카드에 저장되어 있음)
    - Frame이라는 단위를 사용한다.
    - 근거리에 있는 두 지점간의 신뢰성있는 전송을 보장해 주는 역할을 한다.
  - 3계층 : 네트워크층 : 여러 개의 지점을 거칠 때 경로를 찾아준다.
    - ip주소를 이용한다. 
    - 라우터가 라우팅을 통해서 경로를 찾고, 다른 곳에 위치한 서버에 접속한다.
    - 접속하고자 하는 서버의 ip주소가 우리와 동일한 라우터상에 존재하지 않는다면 해당 라우터 바깥쪽에 있는 ip로 포워딩같은 전반적인 일들을 해준다.
    - 전송단위는 패킷이라고 함
    - ip 주소로 패킷을 보내는 일을 하는 곳
  - 4계층 : 전송층 : 양 끝단의 사용자들이 송수신에 있어서 신뢰성을 보장한다.
    - 프로세스와 프로세스의 연결을 도와준다.
    - 예
      - 메신저 프로그램을 실행시켜서 다른 친구와 대화를 하고 있을 때, 그 친구에게 보내는 메세지는 특정한 프로세스의 특정한 포트 번호로 나가게 된다.
      - 즉, 양 끝단의 사용자들의 송 수신에 있어서 신뢰성을 보장한다.
      - 양 끝단 : 하나의 프로그램에 열린 하나의 포트번호 까지의 전달을 의미한다.
  - 5계층 : 세션층 : 양 끝단의 프로세스가 통신을 관리하기 위한 방법을 제공한다.
    - 통신관리 : 동기화나 tcp/ip의 세션 설정같은 것을 의미
    - 연결이 되어있는데 그 상태 자체를 관리할 수 있는 다양한 방법들을 제공해 줄 수 있다.
  - 6계층 : 표현층 : 인코딩 및 데이터의 형식 차이를 조절해 준다.
  - 7계층 : 응용층 : 응용 프로그램에서 서비스를 수행
    - UI등을 이용하여 서비스를 수행하는 계층이다.

- **편지를 보내는 과정으로 비유한 7 Layer**([참고](https://www.youtube.com/watch?v=aTPy201F0AA))

  - 편지를 보낼 때 편지지에 편지를 쓴다 => **응용계층**
  - 편지지를 영어로 썼을때, 받는쪽에서 영어를 이용해서 해석하는 것 => **표현계층**
    - 인코딩과 디코딩을 통해 전송할 데이터를 암호화 복호화한다. 정해진 형식으로 변환해서 해석한다.
    - 예를 들어 미국인이 한국인에게 숫자를 보낸다고 했을 때, one, two, three로 보내는 것이 아니라 1,2,3이라는 형식으로 보내면 한국인은 하나, 둘, 셋으로 읽을 수 있다
  - 전화처럼 쌍방으로 동시에 주고받을 것인지? 무전기 처럼 한쪽씩 번갈아 가며 주고 받을 것인지? 한쪽에서 일방적으로 보낼것인지 논리적인 통신 회선을 생성 유지함 => **세션층**
  - 편지를 누구에게 보낼 것인지? 누가 보내는 것인지?(포트번호) 적어주는것 => **전송층**
    - 추가적으로 TCP, UDP에 대해서 정의를 하는 것
  - 편지를 누구한테 보내는데, 그 사람이 어디에 사는지(IP)? 적어주는것 => **네트워크층**
    - 편지가 어느 경로를 통해서 움직여야 하는지에 대한 내용을 담고 있다.
  - 사람이 사는 아파트까지 도착했을 때, 몇 동 몇 호(MAC)에 사는지 알려주는 것 => **데이터 링크층**

#### TCP/IP와의 관계

- TCP/IP 프로토콜은 미국 국방성에서 개발한 프로토콜로, OSI 7계층 보다 개발 시기가 앞선다.
- TCP/IP는 비공식, OSI 7계층은 국제 공식 표준이다.

- 3계층(네트워크계층)에서 IP, 4계층(전송계층)에서 TCP를 표준 프로토콜로 이용하지만, 일반적인 의미로 TCP/IP는 OSI 7계층 전체에서의 기능적인 표준에 기존의 TCP/IP 개념이 들어가 있다고 볼 수 있다.
- 또한, 실제 업계에서 많이 쓰이는 프로토콜이 TCP/IP 프로토콜이라는 점에서 OSI 모델을 이론적인 모델이라고 칭하기도 한다. 
- 공통점은 둘 다 패킷을 이용해 통신하고 계층 구조를 가지고 있다. 보내는 입장과 받는 입장 모두 각각의 계층에서 통신이 이루어지면 완벽한 상호작용이 가능하다는 것이다.
- 각각의 계층을 이동하면서 캡슐화/역캡슐화가 가능해진다.
- 계층으로 나누어놓으면 문제가 발생했을 때 어떤 계층을 확인하면 되는지 결정할 수 있어서 효율적인 대처가 가능하다.

#### 미디어 계층(하위계층)

- OSI 7계층에서 하위 3계층(물리층, 데이터링크층, 네트워크층)을 포함하는 것. 
- 서로 연결된 컴퓨터 사이의 데이터 전송과 목적지까지의 데이터 전송의 전반을 담당한다.
- **물리층**
  - 네트워크 장비 사이에서 실제로 발생하는 전기적인 통신을 담당한다.
  - 데이터의 전송 단위는 Bit
  - 주로 랜선을 의미하는 것으로 통신에 필요한 공간 자체를 물리층이라고 말한다.
- **데이터 링크층**
  - 네트워크 장비 사이에서 두 지점간의 신뢰성 있는 전송을 보장하기 위한 계층
  - 물리적인 데이터의 전송 등에 관심이 많은 계층이다.
  - 데이터의 전송 단위는 frame
  - 물리적인 주소(MAC 주소)가 상호 통신에 사용된다.
  - ipconfig /all 명령어를 이용해 ip정보를 확인해보면 물리적 주소가 있다. 이 물리적 주소가 랜카드의 주소이다. 물리적주소의 앞 6자리는 만든 회사의 고유번호이고 뒤의 6자리는 장치의 고유번호이다.
- **네트워크 층**
  - 여러 개의 노드를 거칠 때 경로를 찾아주는 역할을 하는 계층이다.
  - 데이터 전송 단위는 패킷
  - 패킷에 ip관련 정보다 담겨 전송된다.
  - 네트워크층에서 경로를 찾기 위한 주소는 ip주소이다.
  - 흔히 사용되는 IPv4는 8비트의 수 4개로 총 32비트 주소 체계이다. IP 주소는 네트워크 부분과 호스트 부분으로 나누어지며 총 5개의 클래스로 구분할 수 있다.
  - 클래스에 따라 앞의 몇 비트가 네트워크 비트고, 뒤의 몇 비트가 호스트 비트인지 나누어진다.
    - Class A : 국가 단위의 거대한 네트워크에 사용되는 주소
      - 네트워크비트 : 8비트
      - 호스트 비트 : 24비트
    - Class B 
      - 네트워크비트 : 16비트
      - 호스트 비트 : 16비트
    - Class C : 학교 단위의 작은 기관에 사용되는 주소
      - 네트워크비트 : 24비트
      - 호스트 비트 : 8비트

#### 호스트 계층

> OSI 7계층에서 상위 계층(세션층, 표현층, 응용층)과 중간 계층(전송층)을 포함하는 것.

#### 중간계층

- **전송층**
  - 양 끝단의 사용자들이 신뢰성 있는 데이터를 주고받을 수 있도록 하는 계층
  - 오류 및 흐름 제어를 진행한다.
  - 데이터 전송단위는 세그먼트
  - 전송층에 들어가는 대표적인 프로토콜은 TCP, UDP가 있다.
  - 컴퓨터에서 실행중인 프로세스까지의 도달을 책임지므로 포트 번호가 중요하게 사용된다.
  - 컴퓨터에서는 2의 16제곱개의 포트 번호가 존재하며 각 프로그램마다 통신을 위한 포트 번호를 사용하게 된다.
  - Well Known Port란 0부터 1023번 까지의 이미 사용 용도가 정해진 포트이며 세계적으로 사용하고 있는 포트 번호 표준이다.
  - 









### TCP와 UDP

- 네트워크 계층 중 전송 계층에서 사용하는 프로토콜
- **TCP**
  - 인터넷 상에서 데이터를 메세지의 형태로 보내기 위해 IP와 함께 사용하는 프로토콜이다.
  - TCP와 IP를 함께 사용하는데, IP가 데이터의 배달을 처리한다면 TCP는 패킷을 추적 및 관리한다.
  - **연결형 서비스**로 **가상 회선 방식**을 제공한다.
    - 3-way handshaking과정을 통해 연결을 설정하고, 4-way handshaking을 통해 연결을 해제한다.
  - 흐름제어 및 혼잡제어를 제공한다.
    - **흐름제어**
      - 데이터를 송신하는 곳과 수신하는 곳의 **데이터 처리 속도를 조절**하여 수신자의 버퍼 오버플로우를 방지하는것
    - **혼잡제어**
      - 네트워크 내의 패킷 수가 넘치게 증가하지 않도록 방지하는 것
      - 정보의 소통량이 과다하면 패캣을 조금만 전송하여 혼잡 붕괴 현상이 일어나는 것을 막는다.
  - 연결 지향 서비스 이므로 높은 신뢰성을 보장하지만 느리다.
  - 전이중(Full-Duplex), 점대점(Point to Point) 방식이다.
    - 전이중
      - 전송이 양방향으로 동시에 일어날 수 있다.
    - 점대점
      - 각 연결이 정확히 2개의 종단점을 가지고 있다.
    - 멀티캐스팅이나 브로트캐스팅을 지원하지 않는다.
  - 연속성보다 신뢰성있는 전송이 중요할 때에 사용된다.
- **UDP**
  - 데이터를 데이터그램 단위로 처리하는 프로토콜이다.
  - **비연결형 서비스**로 **데이터그램** 방식을 제공한다.
    - 연결을 위해 할당되는 논리적인 경로가 없다.
    - 때문에 각각의 패킷은 다른 경로로 전송되고, 각각의 패킷은 독립적인 관계를 지니게된다.
    - 이렇게 데이터를 서로 다른 경로로 독립적으로 처리한다.
  - 정보를 주고 받을 때 정보를 보내거나 받는다는 신호절차를 거치지 않는다.
  - UDP헤더의 CheckSum 필드를 통해 최소한의 오류만 검출한다.
  - 신뢰성이 낮지만 속도가 빠르다.
  - 신뢰성보다는 연속성이 중요한 서비스, 예를 들면 실시간 서비스(스트리밍)에 사용된다.
- **참고**
  - UDP와 TCP는 각각 별도의 포트 주소 공간을 관리하므로 같은 포트 번호를 사용해도 서로 다른 포트로 간주한다.

#### TCP의 3 way handshake와 4 way handshake

- TCP는 장치 사이에 논리적인 접속을 성립하기 위하여 연결을 설정하여 신뢰성을 보장하는 연결형 서비스이다.

- **3 way handshake**

  - TCP 통신을 이용하여 데이터를 전송하기 위해 네트워크 연결을 설정하는 과정이다.
  - 양측 모두 데이터를 전송할 준비가 되었다는 것을 보장하고, 실제로 데이터 전달이 시작하기 전에 한 쪽이 다른 쪽이 준비되었다는 것을 알 수 있도록 한다.
  - 즉, TCP/IP 프로토콜을 이용하여 통신을 하는 응용프로그램이 데이터를 전송하기 전에 먼저 신뢰성있는 전송을 보장하기 위해 사전에 상대방 컴퓨터와 세션을 수립하는 과정을 의미

  - **세션**
    - 네트워크에서 통신 장치 끼리의 송수신 연결상태를 의미한다.

  * A 프로세스(Client)가 B 프로세스( Server )에 연결을 요청하는 과정

    ![img](C:\Users\MSI\Desktop\Career\Study\SW_Study\CS_Study\Pictures\3-way-handshaking.jpg)

    1. A -> B: SYN
       * 접속 요청 프로세스 A가 연결 요청 메세지 전송(SYN)
       * 송신자가 최초로 데이터를 전송할 때 Sequence Number를 임의의 랜덤 숫자로 지정하고, SYN 플래그 비트를 1로 설정한 세그먼트를 전송한다.
       * PORT 상태 - B : LISTEN, A : CLOSED
    2. B -> A : SYN + ACK
       * 접속요청을 받은 프로세스 B가 요청을 수락했으며, 접속 요청 프로세스인 A도 포트를 열어 달라는 메세지 전송( SYN + ACK)
       * 수신자는 Acknowledgement Number 필드를 (Sequence Number + 1)로 지정하고, SYN과 ACK 플래그 비트를 1로 설정한 세그먼트를 전송한다.
       * PORT 상태 - B: SYN_RCV, A: CLOSED
    3. A -> B: ACK
       * PORT 상태 - B: SYN_RCV, A: ESTABLISHED
       * 마지막으로 접속 요청 프로세스 A가 수락 확인을 보내 연결을 맺음 (ACK)
       * 이때, 전송할 데이터가 있으면 이 단계에서 데이터를 전송할 수 있다.
       * PORT 상태 - B: ESTABLISHED, A: ESTABLISHED

- **4-way handshake**

  * TCP의 연결을 해제 하는 과정

  * A 프로세스(Client)가 B 프로세스(Server)에 연결 해제를 요청하는 과정

    ![img](C:\Users\MSI\Desktop\Career\Study\SW_Study\CS_Study\Pictures\4-way-handshaking.jpg)

    1. A -> B : FIN

       * 프로세스 A가 연결을 종료하겠다는 FIN 플래그를 전송

       * 프로세스 B가 FIN 플래그로 응답하기 전까지 연결을 계속 유지

    2. B -> A : ACK

       * 프로세스 B는 일단 확인 메시지를 보내고 자신의 통신이 끝날 때까지 기다린다. (이 상태가 TIME_WAIT 상태)
       * 수신자(B)는 Acknowledgement Number 필드를 (Sequence Number + 1)로 지정하고,  ACK 플래그 비트를 1로 설정한 세그먼트를 전송한다.
       * 그리고 자신이 전송할 데이터가 남아있다면 이어서 계속 전송한다.

    3. B -> A : FIN

       * 프로세스 B가 통신이 끝났으면 연결 종료 요청에 합의한다는 의미로 프로세스 A에게 FIN 플래그를 전송

    4. A -> B : ACK

       * 프로세스 A는 확인했다는 메세지를 전송하고 CLOSED
       * B는 ACK가 들어오면 CLOSED



